<!DOCTYPE html>
<html>

<head>
  <title>ë”± ê±¸ë¦¬ë·° | ì£¼ë¬¸ì„œ</title>

  <!-- Bootstrap CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

  <!-- jquery ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<body>

    <div class="container">
        <br>
        <h1>ì£¼ë¬¸ì„œ</h1>
        <p>ì£¼ë¬¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>

        <br>
        <h5 class="fw-bold">ğŸ˜‹<%= name %></h5>
        <br>
        <label for="adminid" class="form-label">ì¸ì¦ì„œ ID:</label>
        <input type="text" id="id" class="form-control">
        <br>
        <label for="adminid" class="form-label">ì£¼ë¬¸ ë‚´ìš©:</label>
        <input type="text" id="content" class="form-control">
        <br>
        <label for="adminid" class="form-label">ë¦¬ë·° ì´ë²¤íŠ¸ ë²ˆí˜¸:</label>
        <input type="text" id="key" class="form-control">
        <br>
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" value="yes" id="reviewEvent">
          <label class="form-check-label">
            ë¦¬ë·° ì´ë²¤íŠ¸ ì°¸ì—¬ ì—¬ë¶€
          </label>
        </div>
        <br>
        <button class="btn btn-outline-warning" id="btn">ì£¼ë¬¸</button>&nbsp;&nbsp;
        <button class="btn btn-outline-warning" onclick="location.href='/'">ì·¨ì†Œ</button>
        <br>
    </div>
    <br><br>
    <div class="container" id="result"></div>
    <div class="container" id="result1"></div>
</body>
<script>
  $('#btn').click( ()=> {
    // parameterê°€ì ¸ì˜¤ê¸°
    var id = $('#id').val()
    var content = $('#content').val()
    var key = $('#key').val()
    var reviewEvent = document.getElementById('reviewEvent').checked

    console.log(id, content, key, reviewEvent)

    // '/order' POST ìš”ì²­
    $.post('/order', {id, key, reviewEvent}, (data)=>{
      $('#result').empty();
      $('#result1').empty();
      if (data.result == 'success'){ 
        alert("ì£¼ë¬¸ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
        if (data.checked == 'true') {
          $('#result').append('<div class="form-check form-switch"><input class="form-check-input" type="checkbox" value="yes" id="write" checked><label class="form-check-label">ë¦¬ë·° ì“°ê¸°</label></div>')
          $('#result').append('<br><button class="btn btn-outline-warning" id="btn1">í™•ì¸</button><br>')

          $('#btn1').click(()=>{
            var write = document.getElementById('write').checked

            console.log(write)

            $.post('/review', {id, key, write}, (data)=>{
              if(data.result == 'success'){
                if (data.checked == 'true') {
                  alert("ì„±ê³µí–ˆìŠµë‹ˆë‹¤. (ë¦¬ë·° ë¯¸ì…˜ : ì™„ë£Œ)");
                } else {
                    alert("ì„±ê³µí–ˆìŠµë‹ˆë‹¤. (ë¦¬ë·° ë¯¸ì…˜: ë¯¸ì™„ë£Œ)");
                }
                location.href='/'
              } else {
                alert("ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                $('#result1').empty();
                $('#result1').append("<p>"+JSON.stringify(data)+"</p>");
              }
            })
          })
        } else {
          history.back()
        }
      } else {
        alert("ì£¼ë¬¸ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        $('#result').append("<p>"+JSON.stringify(data)+"</p>");
      }
    })
  });
</script>
</html>